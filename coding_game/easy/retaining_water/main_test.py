from typing import List

import main
import pytest


class TestSolution:
    @pytest.mark.parametrize(
        "n, board, expected_volume",
        [
            [
                10,
                [
                    "ZZZZZZZZZZ",
                    "ZAAAAAAAAZ",
                    "ZAAAAAAAAZ",
                    "ZAAAAAAAAZ",
                    "ZAAAAAAAAZ",
                    "ZAAAAAAAAZ",
                    "ZAAAAAAAAZ",
                    "ZAAAAAAAAZ",
                    "ZAAAAAAAAZ",
                    "ZZZZZZZZZZ",
                ],
                1600,
            ],
            [
                10,
                [
                    "ZZZZZZZZZZ",
                    "ZRRRRRRRRZ",
                    "ZRRRRRRRRZ",
                    "ZRRRRRRRRZ",
                    "ZFFFFFFFFZ",
                    "ZDDDDDDDDZ",
                    "ZDDDDDDDDZ",
                    "ZDDDDDDDDZ",
                    "ZDDDDDDDDZ",
                    "ZZZZZZZZZZ",
                ],
                1056,
            ],
            [
                10,
                [
                    "XXXXXXXXXX",
                    "XSSSSRAAAX",
                    "XSSSSRAAAX",
                    "XSSSSRAAAX",
                    "XXXXXCXXXX",
                    "XSSSSCBBBX",
                    "XSSSSCBBBX",
                    "RSSSSCBBBX",
                    "XSSSSCBBBX",
                    "XXXXXXXXXX",
                ],
                449,
            ],
            [
                20,
                [
                    "DDDDDDDDDDDDDDDDDDDD",
                    "DAAAAAAAAAAAABBBCCCC",
                    "DAAAAAAAAAAAABBBDDDD",
                    "DAAAAAAAAAAAABBBDDDD",
                    "DAAAAAAAAAAAABBBEEFF",
                    "GGGGGGGGGHHHIIJJEEFF",
                    "GGGGGGGGGHHHIIJJEEFF",
                    "KKKKKLLLLHHHIIJJMMMM",
                    "KKKKKLLLLNNOOPPPMMMM",
                    "QQQQRRSSSNNOOPPPTTTT",
                    "QQQQRRSSSNNOOUUUTTTT",
                    "VVVVRRWWWNNXXUUUYYYY",
                    "VVVVRRWWWZZXXAAAYYYY",
                    "VVVVBBBBBZZXXAAAYYYY",
                    "VVVVBBBBBZZCCCDDEEFR",
                    "GGGHHHIIIJJCCCDDEEFR",
                    "GGGHHHIIIJJKKKDDEEFR",
                    "GGGHHHIIIJJKKKDDEEFR",
                    "LLLLLLLLLLLLLMMMMNNR",
                    "FFFFFFFFFFFFFFFFFFFF",
                ],
                368,
            ],
            [
                30,
                [
                    "YENZRGRNFKINMCAGFMMGJWVZZRVCWQ",
                    "KKBAQPBNSWUXIDFHDZYNTOGTSAEKVS",
                    "EGTLNXYWRHLLYTNGOYBLULNOIGVMFV",
                    "WKNZBYVPCWLXZSESPZKIACDBLGNTJZ",
                    "MUREWDLLJVTOGPOHWPGIRUDOLEGTRL",
                    "LZKAVBAYBMNMOAAQGQKDCHGNOIBNNZ",
                    "URHBKIZDYSCPSGEHRIGIFEUYAWLYLX",
                    "YASRATWMWKORQIJYHKCYSWRLZIYBYX",
                    "YCDYJTUOFHCWTEXEWIOJFUVVFSJLWL",
                    "GUAWVRQETAUNHQLMARPFPFXCRRGVOI",
                    "TGMCABQJLFBRCYDQMWEKZJBYBFMADN",
                    "GZMUVJKJFZSEWAMIIZWPMWLOQRQJJH",
                    "JOCNZHLCORENIIJQINMRKZDOKPYJNW",
                    "MDGUSXCCKXWQGCFZRBDFGTCHHBFGSB",
                    "QYAZGXUEUMZFUDCSGJZUFGHGUUBWIH",
                    "NUVZDLUUYJYRGQSYHJJUKIAJGEKUQN",
                    "CNBQBDXAFDXNMLSZUOCLOCGYKVOVNE",
                    "PARZOFUPFZTGRITQXCMOZKXHCKBRMA",
                    "IVOKPXQGEHOMLSWIEATJUXAEDBKUFJ",
                    "XVLSZSAOWZOEQCZWBKOTWHNGFQNOQN",
                    "ORYFEBJITOHJHJZHCLJNFZRGLHQRJA",
                    "KZYENAUZGROOZIPCBKRBUNJWUPJRIG",
                    "YNEPCOUEPQFEGGXSTLKWKJJJJORUZB",
                    "GFNHOUWLRQVESEOFDMBQQDCACXLGYF",
                    "EBNNJKZYYOGGVUIDIEROUTFNNSBBXB",
                    "BHRKDBVBBLEMPYVOOKGUPUGAQNMBGT",
                    "ZDOLHRCSCLHTIXRPCTZMFQXCRNNMUT",
                    "SXBRAATOMKNRFGEMNEZKCSXMPKKMJV",
                    "DKMJHUYLWSHBIXJHMXEOSTLMEXUPQB",
                    "SZJSOCBQVELVOOWHGJCTSQOYNFTOKP",
                ],
                2440,
            ],
            [
                40,
                [
                    "XZADHVCOMBACBBHTEYCCXJDNNLMYYDVRQSAOWNOI",
                    "RZTKUWUMFVHBNEXKYVLQDRUFYAQKNIAIMJKBTGTA",
                    "EHAOTIYXUEVIQOXLMWTXJTXHNEZIBUQDRHGWTJOV",
                    "SMNHPIQCWIHIOHQBNMINYYUPKZWHSUFWKUMTENJA",
                    "VLFBINPJBIIXNHREZHUCUEIXMDOBMRMYYFIGTYEA",
                    "WRYSXJRQCGWOCBGQQORMTHLRYRQHACUUNRCHIRFV",
                    "JZBZWXKXMCTICXQALXZKHNXMTGPXXTQMMLHPEHGL",
                    "TTSURBLRCWGWSTVVELLVTCLJCRKTFSDBAOLGRHHN",
                    "OQLAKHARLJNJDIYHWSJRETNNZOVXEDOGNFJBPSXT",
                    "GZSTCXPBKPARDYSQGUUCKCSSPQAIKNVVFIXHWKUK",
                    "KJIAHTGEOGFBMTCQMZFCZGGTALBHOIZDOAEAVUKX",
                    "NABDPPDWUGXPMLOFHJBZJFNALQLXWNSPTCEOWDGD",
                    "ELAECPECRDVSKPUWUECZONMBZONPMZVFJQKCYHLC",
                    "XTFRWZHKFTZOCHDBVJZPPPHXYVBQEAWBOGEFXYIL",
                    "JIBXPJDKZPLTINBAOBUBZIUSISQPQZKUXZEGFHVV",
                    "BGVLWHNHYJNRMTQWWCLDGQVFNSHYDPRESKBWJMBN",
                    "SUFTWVUHUNNBXLBLVPHFNUADPBZIYOCMMJTOGBRU",
                    "VXUQTYNINPBJMLHPKFPDVCBYZCAKWASDPJEFYQPP",
                    "FUOSGBXGUZSODPITUAYOUFGCTYOBQCRCPFQMXFHY",
                    "JIHWAPIPQEKHFDULYPVKZVEOHWFZQJVKVIGIQRLI",
                    "DPIWHKRZVKYOEINTAVFMPBXLVYMGDHCSZIQPELHM",
                    "CJTVHFCMJBOGXWYWAHWXRASNTJFTAXCSJOELOYIN",
                    "ARCQUIJKAJIPLKQNFTYQZFMMHADTCBPRQQUVJXOV",
                    "OEUOOYJNXOUNFZWOOSOYCDISWAMEVFYZFTDCFDFG",
                    "OTQRWRPTUSIKRRYKJVEYGSXQSEGNNPQPVKJJDWDU",
                    "RBIIAEUNUCRKWZWNRLCBRVBFIOWWDBXLWTMBGFIW",
                    "UWYVUNGLTPOAUIVZTFDNAVGPZWSVOIZGBDXNFWKF",
                    "PRNRBRKQTKZPZRPXTJXZCACJFAKTGOVOWRXIQIEY",
                    "ZEJHECJGTJYSAVCBXLKUCDVIGQQGRXNSCOFZSRZJ",
                    "RVUJLHKDVNTYXCWGKPPSIWWTSOJXUYVAEVIFOXKH",
                    "PGLLUAICYQRASURUOGTJNKHAXJLNOGOKXQHQYKRS",
                    "NSVKBFGQFQHPCPUENNCPNWEEJUGUMVFUVXXFMQBA",
                    "KTXYSCTFRGDRRFTKRQFDQTLFNFWRDOMVTQLRLIOX",
                    "BQMCCWRYMHCAMSSRGRPCEPZTYIWAMYQCHSBCAKIM",
                    "LTURGHLZQJZSTFXPPVBHZKKNAMTYPHCVEBFKBABY",
                    "JGYXBZRDJEYUCGFYYZLZXBLUKFHMAJYIDKKWFKRE",
                    "XLLTZANFRHDLEGTCSHWEJYNXNVGXJAJMXPJNVGSB",
                    "WJQQOLKPVIYUFFEMFOJHTJCWASTILFGGHWUECWAJ",
                    "HIQTTIUXRSIKZIBXVKMXEKQKBUGFUMEZGZXCBKQE",
                    "DEHPKLWEXHGMYRYZTGHUAQVIHUZKRTVTARLKCVBN",
                ],
                4832,
            ],
        ],
    )
    def test_solve_method(self, n: int, board: List[str], expected_volume: int) -> None:
        result = main.Solution().solve(n=n, board=board)

        assert result == expected_volume
